var cov_sct4j9p2r=function(){var path="/home/hamptos/Artifacts/code/@shieldsbetter/nearley-indentify/tests/tests.js",hash="2c8aac84b1d35dde1ee901491a477fedb7c36c83",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/home/hamptos/Artifacts/code/@shieldsbetter/nearley-indentify/tests/tests.js",statementMap:{"0":{start:{line:1,column:15},end:{line:1,column:32}},"1":{start:{line:2,column:15},end:{line:2,column:35}},"2":{start:{line:3,column:23},end:{line:3,column:42}},"3":{start:{line:4,column:12},end:{line:4,column:26}},"4":{start:{line:6,column:16},end:{line:10,column:2}},"5":{start:{line:12,column:18},end:{line:122,column:1}},"6":{start:{line:124,column:0},end:{line:147,column:1}},"7":{start:{line:125,column:4},end:{line:125,column:14}},"8":{start:{line:126,column:4},end:{line:126,column:37}},"9":{start:{line:129,column:4},end:{line:146,column:5}},"10":{start:{line:130,column:8},end:{line:130,column:62}},"11":{start:{line:131,column:8},end:{line:131,column:23}},"12":{start:{line:134,column:8},end:{line:134,column:54}},"13":{start:{line:135,column:8},end:{line:135,column:31}},"14":{start:{line:137,column:8},end:{line:140,column:9}},"15":{start:{line:138,column:12},end:{line:138,column:37}},"16":{start:{line:139,column:12},end:{line:139,column:36}},"17":{start:{line:142,column:8},end:{line:145,column:9}},"18":{start:{line:143,column:12},end:{line:143,column:35}},"19":{start:{line:144,column:12},end:{line:144,column:34}},"20":{start:{line:150,column:30},end:{line:150,column:48}},"21":{start:{line:151,column:18},end:{line:151,column:57}},"22":{start:{line:153,column:4},end:{line:153,column:35}},"23":{start:{line:155,column:20},end:{line:155,column:22}},"24":{start:{line:156,column:16},end:{line:156,column:28}},"25":{start:{line:157,column:4},end:{line:160,column:5}},"26":{start:{line:158,column:8},end:{line:158,column:28}},"27":{start:{line:159,column:8},end:{line:159,column:29}},"28":{start:{line:162,column:24},end:{line:162,column:58}},"29":{start:{line:163,column:4},end:{line:165,column:5}},"30":{start:{line:164,column:8},end:{line:164,column:27}},"31":{start:{line:167,column:4},end:{line:181,column:5}},"32":{start:{line:168,column:8},end:{line:180,column:9}},"33":{start:{line:169,column:12},end:{line:172,column:15}},"34":{start:{line:174,column:13},end:{line:180,column:9}},"35":{start:{line:175,column:12},end:{line:179,column:15}},"36":{start:{line:183,column:4},end:{line:188,column:5}},"37":{start:{line:184,column:8},end:{line:187,column:11}},"38":{start:{line:192,column:4},end:{line:200,column:7}},"39":{start:{line:193,column:8},end:{line:199,column:9}},"40":{start:{line:194,column:12},end:{line:194,column:25}},"41":{start:{line:197,column:12},end:{line:197,column:37}},"42":{start:{line:198,column:12},end:{line:198,column:20}},"43":{start:{line:206,column:4},end:{line:219,column:5}},"44":{start:{line:207,column:23},end:{line:207,column:29}},"45":{start:{line:209,column:12},end:{line:209,column:30}},"46":{start:{line:210,column:12},end:{line:210,column:18}},"47":{start:{line:213,column:12},end:{line:213,column:31}},"48":{start:{line:214,column:12},end:{line:214,column:18}},"49":{start:{line:217,column:12},end:{line:217,column:43}},"50":{start:{line:221,column:4},end:{line:221,column:18}},"51":{start:{line:225,column:4},end:{line:225,column:26}},"52":{start:{line:229,column:4},end:{line:229,column:43}},"53":{start:{line:233,column:4},end:{line:233,column:46}}},fnMap:{"0":{name:"doTest",decl:{start:{line:149,column:9},end:{line:149,column:15}},loc:{start:{line:149,column:22},end:{line:189,column:1}},line:149},"1":{name:"doTests",decl:{start:{line:191,column:9},end:{line:191,column:16}},loc:{start:{line:191,column:19},end:{line:201,column:1}},line:191},"2":{name:"(anonymous_2)",decl:{start:{line:192,column:22},end:{line:192,column:23}},loc:{start:{line:192,column:30},end:{line:200,column:5}},line:192},"3":{name:"recognizer",decl:{start:{line:203,column:9},end:{line:203,column:19}},loc:{start:{line:203,column:27},end:{line:222,column:1}},line:203},"4":{name:"token",decl:{start:{line:224,column:9},end:{line:224,column:14}},loc:{start:{line:224,column:21},end:{line:226,column:1}},line:224},"5":{name:"blah",decl:{start:{line:228,column:9},end:{line:228,column:13}},loc:{start:{line:228,column:16},end:{line:230,column:1}},line:228},"6":{name:"whitespace",decl:{start:{line:232,column:9},end:{line:232,column:19}},loc:{start:{line:232,column:22},end:{line:234,column:1}},line:232}},branchMap:{"0":{loc:{start:{line:129,column:4},end:{line:146,column:5}},type:"if",locations:[{start:{line:129,column:4},end:{line:146,column:5}},{start:{line:129,column:4},end:{line:146,column:5}}],line:129},"1":{loc:{start:{line:137,column:8},end:{line:140,column:9}},type:"if",locations:[{start:{line:137,column:8},end:{line:140,column:9}},{start:{line:137,column:8},end:{line:140,column:9}}],line:137},"2":{loc:{start:{line:142,column:8},end:{line:145,column:9}},type:"if",locations:[{start:{line:142,column:8},end:{line:145,column:9}},{start:{line:142,column:8},end:{line:145,column:9}}],line:142},"3":{loc:{start:{line:163,column:4},end:{line:165,column:5}},type:"if",locations:[{start:{line:163,column:4},end:{line:165,column:5}},{start:{line:163,column:4},end:{line:165,column:5}}],line:163},"4":{loc:{start:{line:168,column:8},end:{line:180,column:9}},type:"if",locations:[{start:{line:168,column:8},end:{line:180,column:9}},{start:{line:168,column:8},end:{line:180,column:9}}],line:168},"5":{loc:{start:{line:174,column:13},end:{line:180,column:9}},type:"if",locations:[{start:{line:174,column:13},end:{line:180,column:9}},{start:{line:174,column:13},end:{line:180,column:9}}],line:174},"6":{loc:{start:{line:183,column:4},end:{line:188,column:5}},type:"if",locations:[{start:{line:183,column:4},end:{line:188,column:5}},{start:{line:183,column:4},end:{line:188,column:5}}],line:183},"7":{loc:{start:{line:206,column:4},end:{line:219,column:5}},type:"switch",locations:[{start:{line:207,column:8},end:{line:207,column:31}},{start:{line:208,column:8},end:{line:211,column:9}},{start:{line:212,column:8},end:{line:215,column:9}},{start:{line:216,column:8},end:{line:218,column:9}}],line:206}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0,0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();const assert=(cov_sct4j9p2r.s[0]++,require('assert'));const dedent=(cov_sct4j9p2r.s[1]++,require('dedent-js'));const IndentifyLexer=(cov_sct4j9p2r.s[2]++,require('../index'));const moo=(cov_sct4j9p2r.s[3]++,require('moo'));const baseLex=(cov_sct4j9p2r.s[4]++,moo.compile({indentSource:'-->',blah:/\w+/,eol:{match:/\n/,lineBreaks:true}}));const testCases=(cov_sct4j9p2r.s[5]++,[{name:'no tokens',input:``,output:``},{name:'internal indents passed along',input:`
            blah-->blah-->blah
        `,output:`
            blah indentSource blah indentSource blah
        `},{name:'basic indent',input:`
            blah-->blah
            -->blah-->blah
            -->blah
            blah
        `,output:`
            blah indentSource blah
            indent blah indentSource blah newline
            blah
            dedent blah
        `},{name:'multiple indent tokens are one indent',input:`
            blah
            -->-->blah
            blah
        `,output:`
            blah
            indent blah
            dedent blah
        `},{name:'multiple indent levels',input:`
            blah
            -->blah
            -->-->blah
            -->blah
            blah
        `,output:`
            blah
            indent blah
            indent blah
            dedent blah
            dedent blah
        `},{name:'dedent through multiple levels',input:`
            blah
            -->blah
            -->-->blah
            blah
        `,output:`
            blah
            indent blah
            indent blah
            dedent dedent blah
        `},{name:'auto-dedent at end',input:`
            blah
            -->blah
            -->-->blah
        `,output:`
            blah
            indent blah
            indent blah
            dedent dedent
        `},{name:'empty lines belong to last block',input:`
            blah
            -->-->-->blah
            -->-->-->
            -->-->
            -->-->-->-->
            
            blah
            
        `,output:`
            blah
            indent blah newline
            newline
            newline
            newline
            dedent blah newline
        `}]);cov_sct4j9p2r.s[6]++;try{cov_sct4j9p2r.s[7]++;doTests();cov_sct4j9p2r.s[8]++;console.log('All tests passed.');}catch(e){cov_sct4j9p2r.s[9]++;if(e.code!=='ERR_ASSERTION'){cov_sct4j9p2r.b[0][0]++;cov_sct4j9p2r.s[10]++;console.log(`Test "${e.sourceTest}" threw an error:`);cov_sct4j9p2r.s[11]++;console.log(e);}else{cov_sct4j9p2r.b[0][1]++;cov_sct4j9p2r.s[12]++;console.log(`Test "${e.sourceTest}" failed:`);cov_sct4j9p2r.s[13]++;console.log(e.message);cov_sct4j9p2r.s[14]++;if(e.expected){cov_sct4j9p2r.b[1][0]++;cov_sct4j9p2r.s[15]++;console.log('Expected:');cov_sct4j9p2r.s[16]++;console.log(e.expected);}else{cov_sct4j9p2r.b[1][1]++;}cov_sct4j9p2r.s[17]++;if(e.actual){cov_sct4j9p2r.b[2][0]++;cov_sct4j9p2r.s[18]++;console.log('Actual:');cov_sct4j9p2r.s[19]++;console.log(e.actual);}else{cov_sct4j9p2r.b[2][1]++;}}}function doTest(test){cov_sct4j9p2r.f[0]++;const dedentedTestInput=(cov_sct4j9p2r.s[20]++,dedent(test.input));const lexer=(cov_sct4j9p2r.s[21]++,new IndentifyLexer(baseLex,recognizer));cov_sct4j9p2r.s[22]++;lexer.reset(dedentedTestInput);const results=(cov_sct4j9p2r.s[23]++,[]);let token=(cov_sct4j9p2r.s[24]++,lexer.next());cov_sct4j9p2r.s[25]++;while(token!==undefined){cov_sct4j9p2r.s[26]++;results.push(token);cov_sct4j9p2r.s[27]++;token=lexer.next();}let expectedTypes=(cov_sct4j9p2r.s[28]++,test.output.trim().split(/[ \n]+/));cov_sct4j9p2r.s[29]++;if(expectedTypes[0]===''){cov_sct4j9p2r.b[3][0]++;cov_sct4j9p2r.s[30]++;expectedTypes=[];}else{cov_sct4j9p2r.b[3][1]++;}cov_sct4j9p2r.s[31]++;for(let i=0;i<expectedTypes.length;i++){cov_sct4j9p2r.s[32]++;if(i>=results.length){cov_sct4j9p2r.b[4][0]++;cov_sct4j9p2r.s[33]++;throw new assert.AssertionError({message:'Expected another token, but found none.',expected:'type '+expectedTypes[i]});}else{cov_sct4j9p2r.b[4][1]++;cov_sct4j9p2r.s[34]++;if(results[i].type!==expectedTypes[i]){cov_sct4j9p2r.b[5][0]++;cov_sct4j9p2r.s[35]++;throw new assert.AssertionError({message:`Token ${i} had unexpected type.`,expected:'['+expectedTypes[i]+']',actual:'['+results[i].type+']'});}else{cov_sct4j9p2r.b[5][1]++;}}}cov_sct4j9p2r.s[36]++;if(results.length>expectedTypes.length){cov_sct4j9p2r.b[6][0]++;cov_sct4j9p2r.s[37]++;throw new assert.AssertionError({message:'Expected end of stream but got another token.',actual:results[expectedTypes.length]});}else{cov_sct4j9p2r.b[6][1]++;}}function doTests(){cov_sct4j9p2r.f[1]++;cov_sct4j9p2r.s[38]++;testCases.forEach(test=>{cov_sct4j9p2r.f[2]++;cov_sct4j9p2r.s[39]++;try{cov_sct4j9p2r.s[40]++;doTest(test);}catch(e){cov_sct4j9p2r.s[41]++;e.sourceTest=test.name;cov_sct4j9p2r.s[42]++;throw e;}});}function recognizer(token){cov_sct4j9p2r.f[3]++;let result;cov_sct4j9p2r.s[43]++;switch(token.type){case'blah':cov_sct4j9p2r.b[7][0]++;{cov_sct4j9p2r.s[44]++;break;}case'indentSource':cov_sct4j9p2r.b[7][1]++;{cov_sct4j9p2r.s[45]++;result='indent';cov_sct4j9p2r.s[46]++;break;}case'eol':cov_sct4j9p2r.b[7][2]++;{cov_sct4j9p2r.s[47]++;result='newline';cov_sct4j9p2r.s[48]++;break;}default:cov_sct4j9p2r.b[7][3]++;{cov_sct4j9p2r.s[49]++;throw new Error('Wait, what?');}}cov_sct4j9p2r.s[50]++;return result;}function token(type){cov_sct4j9p2r.f[4]++;cov_sct4j9p2r.s[51]++;return{type:type};}function blah(){cov_sct4j9p2r.f[5]++;cov_sct4j9p2r.s[52]++;return{value:'blah',type:'blah'};}function whitespace(){cov_sct4j9p2r.f[6]++;cov_sct4j9p2r.s[53]++;return{value:' ',type:'whitespace'};}